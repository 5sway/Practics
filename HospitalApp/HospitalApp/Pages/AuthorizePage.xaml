<Page x:Class="HospitalApp.AuthorizePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:HospitalApp"
      xmlns:gif="http://wpfanimatedgif.codeplex.com"
      mc:Ignorable="d" 
      d:DesignHeight="450" d:DesignWidth="800"
      Title="AuthorizePage">
    <Page.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
    </Page.Resources>
    <Grid>
        <!-- Контейнер для капчи -->
        <Grid Name="CaptchaContainer" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,0,0" Panel.ZIndex="2" Visibility="{Binding CaptchaVisibility}">
            <Image Name="CaptchaImage" Width="230" Height="70" Margin="0,0,0,150"/>
            <Grid Width="230" Height="30" Margin="0,0,0,25">
                <TextBox Name="CaptchaTextBox" KeyDown="CaptchaTextBox_KeyDown" FontSize="14" Padding="5" Width="230" Height="30" VerticalContentAlignment="Center" FontFamily="Calibri" GotFocus="CaptchaTextBox_GotFocus" LostFocus="CaptchaTextBox_LostFocus"/>
                <TextBlock Name="CaptchaText" Text="Enter captcha" Padding="5" TextAlignment="Center" VerticalAlignment="Center" MouseDown="CaptchaText_MouseDown" FontSize="14" FontFamily="Calibri" Width="230" Height="30" IsHitTestVisible="True"/>
            </Grid>
            <Button Name="RefreshCaptcha" Background="Transparent" BorderThickness="0" FontSize="16" Click="RefreshCaptcha_Click" Width="30" Height="30" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="200,0,0,25">
                <Image Name="RefreshGif" Source="/Resources/loader (1).gif" gif:ImageBehavior.RepeatBehavior="1x" gif:ImageBehavior.AutoStart="False"/>
            </Button>
            <Button Name="VerifyCaptchaBtn" Content="Verify" Background="#6EDC82" FontSize="16" Click="CaptchaSubmitBtn_Click" Width="160" Height="30" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="0,50,0,0"/>
        </Grid>
        <!-- Поля ввода логина -->
        <Grid Name="LoginContainer" Width="250" Height="35" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,0,100" Visibility="{Binding InputVisibility}">
            <TextBox Name="LoginTextBox" KeyDown="LoginTextBox_KeyDown" FontSize="18" Padding="10,0,0,0" Width="250" Height="35" VerticalContentAlignment="Center" FontFamily="Calibri" GotFocus="LoginBox_GotFocus" LostFocus="LoginBox_LostFocus" IsEnabled="{Binding IsInputEnabled}"/>
            <TextBlock Name="LoginTxt" Text="Login" Padding="10,6,0,0" TextAlignment="Left" VerticalAlignment="Center" MouseDown="LoginTxt_MouseDown" FontSize="18" FontFamily="Calibri" Width="250" Height="35" IsHitTestVisible="True"/>
        </Grid>
        <!-- Поля ввода пароля -->
        <Grid Name="PasswordContainer" Width="250" Height="35" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,0,0" Visibility="{Binding InputVisibility}">
            <PasswordBox Name="PasswordTextBox" KeyDown="PasswordTextBox_KeyDown" FontSize="18" Padding="10,0,0,0" Width="250" Height="35" VerticalContentAlignment="Center" FontFamily="Calibri" GotFocus="PasswordBox_GotFocus" LostFocus="PasswordBox_LostFocus" IsEnabled="{Binding IsInputEnabled}" Visibility="Visible"/>
            <TextBox Name="PasswordTextBoxVisible" KeyDown="PasswordTextBox_KeyDown" FontSize="18" Padding="10,0,0,0" Width="250" Height="35" VerticalContentAlignment="Center" FontFamily="Calibri" GotFocus="PasswordBox_GotFocus" LostFocus="PasswordBox_LostFocus" IsEnabled="{Binding IsInputEnabled}" Visibility="Collapsed"/>
            <TextBlock Name="PasswordTxt" Text="Password" Padding="10,6,0,0" TextAlignment="Left" VerticalAlignment="Center" MouseDown="PasswordTxt_MouseDown" FontSize="18" FontFamily="Calibri" Width="250" Height="35" IsHitTestVisible="True"/>
            <Button Name="TogglePasswordBtn" Background="Transparent" BorderThickness="0" Width="30" Height="30" HorizontalAlignment="Right" Margin="0,0,2,0" Click="TogglePasswordBtn_Click" Visibility="{Binding IsPasswordNotEmpty, Converter={StaticResource BooleanToVisibilityConverter}}">
                <Image Name="TogglePasswordIcon" Source="/Resources/eye_animation.gif" Stretch="Fill" gif:ImageBehavior.AutoStart="False" gif:ImageBehavior.RepeatBehavior="1x"/>
            </Button>
        </Grid>
        <!-- Кнопки -->
        <Button Name="LoginBtn" Content="Login" Background="#6EDC82" FontSize="14" Click="LoginBtn_Click" Width="100" Height="30" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="0,90,120,0" Visibility="{Binding InputVisibility}" IsEnabled="{Binding IsInputEnabled}"/>
        <Button Name="CancelBtn" Content="Cancel" Background="#6EDC82" FontSize="14" Click="CancelBtn_Click" Width="100" Height="30" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="120,90,0,0" Visibility="{Binding InputVisibility}" IsEnabled="{Binding IsInputEnabled}"/>
        <!-- Ошибка -->
        <TextBlock Name="ErrorText" Text="{Binding ErrorMessage}" Foreground="Red" FontSize="14" TextAlignment="Center" Margin="0,0,0,0" Visibility="{Binding ErrorVisibility}" TextWrapping="Wrap" MaxWidth="300" HorizontalAlignment="Center"/>
    </Grid>
</Page>